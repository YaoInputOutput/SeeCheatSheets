# 目录
<!-- vim-markdown-toc GFM -->

- [资源](#资源)
- [事务](#事务)
- [报文](#报文)
- [连接](#连接)
- [web结构组件](#web结构组件)

<!-- vim-markdown-toc -->

# 资源
资源可能是静态文件，也可能是从程序生成的动态数据
* MIME(多用途因特网邮件扩展)类型
* URI
    * URN
    * URL：`<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag>`
        * 相对URL（可移植性）
        * 自动扩展URL
        * 安全字符与非安全字符的转义

# 事务
| 方法    | 描述                                               | 是否包含主体 |
|---------|----------------------------------------------------|--------------|
| GET     | 从服务器获取一份文档                               | 否           |
| HEAD    | 只从服务器获取文档的首部                           | 否           |
| POST    | 向服务器发送需要处理的数据                         | 是           |
| PUT     | 将请求的主体部分存储在服务器上                     | 是           |
| DELETE  | 从服务器上删除一份文档                             | 否           |
| CONNECT | 建立隧道                                           | 否           |
| TRACE   | 对可能经过代理服务器传送到服务器上去的报文进行追踪 | 否           |
| OPTIONS | 决定可以在服务器上执行哪些方法                     | 否           |

| 状态码 | 描述                  |
|--------|-----------------------|
| 200    | OK                    |
| 400    | Bad Request           |
| 401    | Unauthonzed           |
| 403    | Forbidden             |
| 404    | Not Found             |
| 500    | Internal Server Error |
| 503    | Service Unavailable   |

# 报文

请求报文格式
> 方法 URI 协议版本

![http请求报文格式](images/http.jpg)

响应报文格式
> 协议版本 状态码 描述

![http响应报文格式](images/httpd.png)

常用首部行
> 分行写是次行必须以space或tab开头

| 首部              | 字段值                               |
|-------------------|--------------------------------------|
| Host              | 目的主机名`google.com`               |
| User-Agent        | 浏览器类型`Mozilla/5.0`              |
| Connection        | 连接方式`close\|Keep-Alive`          |
| Accept            | 内容类型`*/*`                        |
| Accept-Language   | 自然语言`zh-CN`                      |
| Accept-Encoding   | 压缩格式`gzip`                       |
| Accept-Charset    | 字符编码`ISO-8859-1`                 |
| If-Modified-Since | 是否已变更`Wed, 9 Sep 2015 09:23:24` |
| Cookie            | 客户端存储目的域名的Cookie           |
| Reference         | 由`URL`跳转而来                      |

# 连接
* 短连接：
    * 管理方便，建立一次连接只进行一次请求与一次响应，无需在意TCP流式数据传输粘包
    * TCP连接建立与断开的开销以及慢启动导致的高延迟
* 长连接：
    * 节省TCP连接的建立与关闭的开销并减少慢启动
    * 静态资源数据长度由`Content-Length`指明，动态资源数据长度通过分块传输编码判断
    * 服务端需要为每个客户端连接保留资源，服务端一般存在保活机制来探测无效连接并关闭之
* HTTP 2.0：
    * 多路复用，二进制分帧从而让所有数据流共用同一个TCP连接并发通讯，而非必须等待响应后才能进行下一条请求

* 时延性能聚焦：
    * 连接建立
    * 拥塞控制（尤其慢启动）
    * 数据聚集的Nagle算法（尽量填充MSS）
    * 延迟累计确认
    * TIME_WAIT时延与端口耗尽
* 解决方案：
    * 并发连接
    * 持久连接
    * 管道化连接

# web结构组件
* 代理
* 缓存
* 网关
* 隧道
* Agent代理

* Cookie：
    * 客户端：记录本机在服务器上对应的Cookie号
    * 服务器：记录客户端在本机上对应的Cookie号，以及相应的用户信息。

* Web代理/缓存：
    * 进行代理访问
    * 缓存http报文

* DASH：基于HTTP的动态适应性流  
    将视频编码为多个清晰度的版本，并将每个版本的视频切分为块，下载时动态选择将要下载的块的版本
